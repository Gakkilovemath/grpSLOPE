<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Alexej Gossmann" />

<meta name="date" content="2016-02-12" />

<title>Basic usage of grpSLOPE</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Basic usage of grpSLOPE</h1>
<h4 class="author"><em>Alexej Gossmann</em></h4>
<h4 class="date"><em>2016-02-12</em></h4>
</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Group SLOPE is a penalized linear regression method that is used for adaptive selection of groups of significant predictors in a high-dimensional linear model. It was introduced in <a href="http://arxiv.org/abs/1511.09078">Brzyski et. al. (2015) <em>Group SLOPE — adaptive selection of groups of predictors</em></a> and <a href="http://dx.doi.org/10.1145/2808719.2808743">Gossmann et. al. (2015) <em>Identification of Significant Genetic Variants via SLOPE, and Its Extension to Group SLOPE</em></a>. A unique feature of the Group SLOPE method is that it offers (group) false discovery rate control (i.e., control of the expected proportion of irrelevant groups among the total number of groups selected by the Group SLOPE method).</p>
</div>
<div id="data-generation" class="section level2">
<h2>Data generation</h2>
<p>We simulate a SNP-data-like model matrix.</p>
<p><strong>Note:</strong> In fact, the Group SLOPE method is designed to work with a data matrix, where the columns corresponding to different groups of predictors are nearly orthogonal. Only for the brevity of exposition we do not check for or enforce low between group correlations in this example.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)

p     &lt;-<span class="st"> </span><span class="dv">500</span>
probs &lt;-<span class="st"> </span><span class="kw">runif</span>(p, <span class="fl">0.1</span>, <span class="fl">0.5</span>)
probs &lt;-<span class="st"> </span><span class="kw">t</span>(probs) %x%<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,p,<span class="dv">2</span>)
X0    &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbinom</span>(<span class="dv">2</span>*p*p, <span class="dv">1</span>, probs), p, <span class="dv">2</span>*p)
X     &lt;-<span class="st"> </span>X0 %*%<span class="st"> </span>(<span class="kw">diag</span>(p) %x%<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>))</code></pre>
<p>Upper left <span class="math">\(10 \times 10\)</span> corner of <span class="math">\(X\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">pander::<span class="kw">pandoc.table</span>(X[<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">1</span>:<span class="dv">10</span>])</code></pre>
<table>
<colgroup>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
<col width="2%"></col>
</colgroup>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">2</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>We divide the predictors into 100 groups of sizes from ranging from 3 to 7.</p>
<pre class="sourceCode r"><code class="sourceCode r">group &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">20</span>, <span class="dt">each=</span><span class="dv">3</span>),
           <span class="kw">rep</span>(<span class="dv">21</span>:<span class="dv">40</span>, <span class="dt">each=</span><span class="dv">4</span>),
           <span class="kw">rep</span>(<span class="dv">41</span>:<span class="dv">60</span>, <span class="dt">each=</span><span class="dv">5</span>),
           <span class="kw">rep</span>(<span class="dv">61</span>:<span class="dv">80</span>, <span class="dt">each=</span><span class="dv">6</span>),
           <span class="kw">rep</span>(<span class="dv">81</span>:<span class="dv">100</span>, <span class="dt">each=</span><span class="dv">7</span>))
group.id &lt;-<span class="st"> </span>grpSLOPE::<span class="kw">getGroupID</span>(group)
n.group &lt;-<span class="st"> </span><span class="kw">length</span>(group.id)
group.length &lt;-<span class="st"> </span><span class="kw">sapply</span>(group.id, <span class="dt">FUN=</span>length)</code></pre>
<p>We randomly select 10 groups to be truly significant.</p>
<pre class="sourceCode r"><code class="sourceCode r">ind.relevant &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:n.group, <span class="dv">10</span>)
<span class="kw">print</span>(<span class="kw">sort</span>(ind.relevant))</code></pre>
<pre><code>##  [1]  4 19 24 26 28 42 50 55 67 74</code></pre>
<p>Then we generate the vector of predictor coefficients and the response vector according to a linear model.</p>
<pre class="sourceCode r"><code class="sourceCode r">b &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, p)
for (j in ind.relevant) {
  b[group.id[[j]]] &lt;-<span class="st"> </span><span class="kw">runif</span>(group.length[j])
}

<span class="co"># generate the response vector</span>
y &lt;-<span class="st"> </span>X %*%<span class="st"> </span>b +<span class="st"> </span><span class="kw">rnorm</span>(p)</code></pre>
</div>
<div id="fitting-the-group-slope-model" class="section level2">
<h2>Fitting the Group SLOPE model</h2>
<p>We fit the Group SLOPE model to the simulated data. The function argument <code>fdr</code> signifies the target (group-wise) false discovery rate of the variable selection procedure.</p>
<pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span>grpSLOPE::<span class="kw">grpSLOPE</span>(<span class="dt">X=</span>X, <span class="dt">y=</span>y, <span class="dt">group=</span>group, <span class="dt">fdr=</span><span class="fl">0.1</span>, <span class="dt">lambda=</span><span class="st">&quot;chiMean&quot;</span>)</code></pre>
<p>We can display which groups were selected as significant by the Group SLOPE method.</p>
<pre class="sourceCode r"><code class="sourceCode r">result$selected</code></pre>
<pre><code>##  [1] &quot;4&quot;  &quot;10&quot; &quot;19&quot; &quot;24&quot; &quot;26&quot; &quot;28&quot; &quot;42&quot; &quot;50&quot; &quot;55&quot; &quot;67&quot; &quot;74&quot;</code></pre>
<p>It might also be interesting to plot the first few elements of the regularizing sequence <span class="math">\(\lambda\)</span> used by the Group SLOPE method for the given inputs.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(result$lambda[<span class="dv">1</span>:<span class="dv">10</span>], <span class="dt">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Lambda&quot;</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,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" /><br /></p>
</div>
<div id="evaluating-the-results" class="section level2">
<h2>Evaluating the results</h2>
<p>We check the performance of the method by computing the resulting (group) false discovery proportion (gFDP) and power.</p>
<pre class="sourceCode r"><code class="sourceCode r">n.selected    &lt;-<span class="st"> </span><span class="kw">length</span>(result$selected)
true.relevant &lt;-<span class="st"> </span><span class="kw">names</span>(group.id)[ind.relevant]
truepos       &lt;-<span class="st"> </span><span class="kw">intersect</span>(result$selected, true.relevant)

n.truepos  &lt;-<span class="st"> </span><span class="kw">length</span>(truepos)
n.falsepos &lt;-<span class="st"> </span>n.selected -<span class="st"> </span>n.truepos

FDP &lt;-<span class="st"> </span>n.falsepos /<span class="st"> </span><span class="kw">max</span>(<span class="dv">1</span>, n.selected)
pow &lt;-<span class="st"> </span>n.truepos /<span class="st"> </span><span class="kw">length</span>(true.relevant)

<span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;FDP =&quot;</span>, FDP))</code></pre>
<p>[1] “FDP = 0.0909090909090909”</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Power =&quot;</span>, pow))</code></pre>
<p>[1] “Power = 1”</p>
<p>We see that the method indeed did not exceed the target FDR, while maintaining a high power.</p>
</div>
<div id="lambda-sequence" class="section level2">
<h2>Lambda sequence</h2>
<p>Multiple ways to select the regularizing sequence <span class="math">\(\lambda\)</span> are available.</p>
<p>If a group structure with little correlation between groups can be assumed (i.e., groups in the standardized model matrix are nearly orthogonal), then we suggest to use the sequence <code>chiMean</code>, which is the default.</p>
<p>When groups of predictors cannot be assumed to be nearly orthogonal then the Monte Carlo based sequences <code>chiMC</code> and <code>gaussianMC</code> can be used. However this can increase the computation time significantly.</p>
<p>The sequences <code>chiOrthoMean</code> and <code>chiOrthoMax</code> can be used together with the options <code>orthogonalize=FALSE</code> and <code>normalize=FALSE</code>, when the columns of the model matrix are exactly orthogonal to each other.</p>
<p>We do not suggest to use any of the other sequences unless you are an expert on the SLOPE method.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
